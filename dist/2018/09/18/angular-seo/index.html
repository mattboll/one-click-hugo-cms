<!doctype html>
<html lang="fr">
  <head>
  <title>Code-Troopers - SEO et Single Page Application</title>
  
  
  <link
    href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css"
    rel="stylesheet"
/>

	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <base href="/">
	
	<link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
	<link rel="icon" href="/favicon.ico">
	<link rel="manifest" href="/manifest.json">
	<link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#ff4400">
	<meta name="theme-color" content="#fff">

  
  <meta property="og:title" content="SEO et Single Page Application" />
<meta property="og:description" content="Lorsque nous avons commencé à développer We Guide, nous avons pas mal réfléchi à quel framework utiliser pour réaliser la partie front et, du fait de notre expérience, avons choisi Angular. Nous connaissions les problèmes liés aux Single Page Application et au SEO mais nous pensions pouvoir les résoudre facilement par la suite. Au final, c’était un peu plus compliqué que prévu et nous allons expliquer pourquoi dans la suite de cet article." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2018/09/18/angular-seo/" /><meta property="og:image" content="/img/gopher_moi.png"/><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2018-09-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-09-18T00:00:00+00:00" />


  
</head>
  <body class="sans-serif">

    <header>
    <nav>
        <a href="/" class="brand">Code-Troopers</a>
        
            <a href="#skills">Compétences</a>
        
            <a href="#portfolio">Réalisations</a>
        
            <a href="#team">L&#39;équipe</a>
        
            <a href="#blogs">Blog</a>
        
    </nav>
</header>

    

<div class="fr-container">
    <h1 class="f2 lh-title b mb3">SEO et Single Page Application</h1>
    <div class="fr-grid-row">
      <p class="fr-col-6">mardi 18 septembre 2018</p>
      <p class="fr-col-6">Lire en 4 minutes</p>
    </div>
    <div class="cms mw6">
      <p></p>
      
      <div class="paragraph">
<p>Lorsque nous avons commencé à développer <a href="https://www.weguide.fr" target="_blank" rel="noopener">We Guide</a>, nous avons pas mal réfléchi à quel framework utiliser pour réaliser la partie front et, du fait de notre expérience, avons choisi <strong>Angular</strong>.
Nous connaissions les problèmes liés aux <strong>Single Page Application</strong> et au <strong>SEO</strong> mais nous pensions pouvoir les résoudre facilement par la suite.
Au final, c’était un peu plus compliqué que prévu et nous allons expliquer pourquoi dans la suite de cet article.</p>
</div>
<div class="sect1">
<h2 id="_les_balises_meta">Les balises &lt;meta&gt;</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Angular fournit deux services afin de modifier les balises <strong>HTML</strong> destinées au <strong>SEO</strong> lors de l’affichage d’une page, <code>Meta</code> et <code>Title</code> qui, comme leur nom l’indique, permettent de modifier les balises <code>&lt;meta&gt;</code> et <code>&lt;title&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Voici un exemple de service créé pour mettre à jour les balises meta destinées à l’OpenGraph et à Twitter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">@Injectable({
  providedIn: &#39;root&#39;
})
export class SeoService {

  constructor(private meta: Meta,
              private title: Title) {
  }

  generateTags(config) {
    // default values
    config = {
      title: &#39;Titre de la page&#39;,
      description: &#39;Description de la page par défaut&#39;,
      image: &#39;http://imagepardefaut.com&#39;,
      ...config
    };

    this.meta.updateTag({name: &#39;twitter:card&#39;, content: &#39;summary&#39;});
    this.meta.updateTag({name: &#39;twitter:site&#39;, content: &#39;@twitter&#39;});
    this.meta.updateTag({name: &#39;twitter:title&#39;, content: config.title});
    this.meta.updateTag({name: &#39;twitter:description&#39;, content: config.description});
    this.meta.updateTag({name: &#39;twitter:image&#39;, content: config.image});

    this.meta.updateTag({property: &#39;og:type&#39;, content: &#39;article&#39;});
    this.meta.updateTag({property: &#39;og:site_name&#39;, content: &#39;SiteName&#39;});
    this.meta.updateTag({property: &#39;og:title&#39;, content: config.title});
    this.meta.updateTag({property: &#39;og:description&#39;, content: config.description});
    this.meta.updateTag({property: &#39;og:image&#39;, content: config.image});
    this.meta.updateTag({property: &#39;og:url&#39;, content: `https://monurl/`});

    this.title.setTitle(config.title);
    this.meta.addTags([
      {name: &#39;description&#39;, content: config.description},
      {name: &#39;keywords&#39;, content: config.description},
    ]);
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_le_sitemap">Le Sitemap</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Une autre partie du <strong>SEO</strong> indispensable est le sitemap.
Il permet aux robots de savoir exactement quelles pages indexer.
Problème, sur une application comme <strong>We Guide</strong>, nous ne pouvons pas écrire ce fichier en dur, en effet, des nouveaux guides créent leur profil tous les jours sur la plateforme, ce qui veut dire, une nouvelle url en plus à indexer.</p>
</div>
<div class="paragraph">
<p>Pour remédier à cela c’est assez simple, il faut que le fichier soit dynamique et généré à la volée par votre serveur.
Pour faire cela, il suffit de servir une route <code>/sitemap</code> qui retourne un fichier <strong>XML</strong> généré à l’aide d’appel aux différents services de votre application.</p>
</div>
<div class="paragraph">
<p>Voici un exemple sur une application <strong>Spring Boot</strong> en <strong>Kotlin</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Component
class SitemapView(@Autowired val sitemapService: SitemapService) : AbstractView() {
    override fun renderMergedOutputModel(model: MutableMap&lt;String, Any&gt;?,
                                         request: HttpServletRequest?,
                                         response: HttpServletResponse?) {
        response?.contentType = APPLICATION_XML_VALUE
        response?.writer?.append(sitemapService.createSitemap())
    }
}

@RestController
class SitemapController(@Autowired val sitemapView: SitemapView) {
    @GetMapping(&#34;/sitemap&#34;, produces = arrayOf(APPLICATION_XML_VALUE))
    fun generateSiteMap(): SitemapView {
        return sitemapView
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pour générer le fichier <strong>XML</strong>, nous avons utilisé cette librairie <a href="https://github.com/lgraubner/sitemap-generator" target="_blank" rel="noopener">https://github.com/lgraubner/sitemap-generator</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_le_rendu_côté_serveur">Le rendu côté serveur</h2>
<div class="sectionbody">
<div class="paragraph">
<p>La dernière étape est la plus compliquée.
Il faut ajouter une logique au niveau du serveur front qui, si l’appel vient d’un robot, le redirige vers un service permettant de générer le code <strong>HTML</strong> final de notre page car le problème des robots c’est que un, ils n’aiment pas le javascript (le moteur utilisé n’est pas récent) et deux, ils n’aiment pas attendre.</p>
</div>
<div class="paragraph">
<p>Le service en question que nous avons choisi se nomme <strong>Rendertron</strong> (<a href="https://github.com/GoogleChrome/rendertron" target="_blank" rel="noopener">https://github.com/GoogleChrome/rendertron</a>). Ce n’est rien d’autre qu’un <strong>Google Chrome</strong> headless auquel on envoie l’url de la page que l’on désire et nous renvoie le code <strong>HTML</strong> en réponse.</p>
</div>
<div class="paragraph">
<p>Pour décider si l’on doit faire du rendu côté serveur ou du rendu côté client, nous nous sommes inspirés d’une librairie Java <a href="https://github.com/greengerong/prerender-java" target="_blank" rel="noopener">https://github.com/greengerong/prerender-java</a>.
Cette librairie fournit directement un filtre <strong>HTTP</strong> permettant de rediriger vers une url si le <code>User-Agent</code> est compris dans la liste des robots de crawling.</p>
</div>
<div class="paragraph">
<p>Il nous a suffit de brancher ce filtre au niveau de <strong>Spring Boot</strong> comme ceci :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Bean
public FilterRegistrationBean registerSeoFilter() {
    PreRenderSEOFilter seoFilter = new PreRenderSEOFilter();
    FilterRegistrationBean filterRegistrationBean = new FilterRegistrationBean();

    filterRegistrationBean.setFilter(seoFilter);
    filterRegistrationBean.addInitParameter(
        &#34;prerenderServiceUrl&#34;,
        env.getProperty(&#34;application.rendertron.url&#34;)+&#34;/render&#34;);

    filterRegistrationBean.addUrlPatterns(&#34;/*&#34;);

    return filterRegistrationBean;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_validation">Validation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Une fois que vous avez fait toutes vos modifications, vous pouvez tester le bon fonctionnement grâce à plusieurs outils :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://cards-dev.twitter.com/validator" target="_blank" rel="noopener">https://cards-dev.twitter.com/validator</a> : le système de <strong>Twitter</strong> pour vérifier l’aperçu d’un lien quand on le partage dans un tweet.</p>
</li>
<li>
<p><a href="https://search.google.com/search-console" target="_blank" rel="noopener">https://search.google.com/search-console</a> : la <strong>Google Search Console</strong>, l’outil de <strong>Google</strong> vous permet de voir le <strong>HTML</strong> ou même une capture d’écran d’une URL de votre site de la façon dont voit le robot d’indexation de <strong>Google</strong>. Il vous permet aussi de consulter le sitemap et voir si ses urls ont bien été indexées.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Enfin vous n’avez plus qu’à attendre quelques jours que les différents robots passent sur votre site afin de voir les résultats sur les différents moteurs de recherche.</p>
</div>
<div class="paragraph">
<p>Pour <strong>We Guide</strong>, nous sommes actuellement entrain de tester cette amélioration sur notre plateforme de recette et on espère déployer la version de production très prochainement.</p>
</div>
</div>
</div>

    </div>
</div>



    <section id="contact">
    <h1>Contact</h1>
    <div>
        <div><iframe
                    width="100%"
                    height="100%"
                    loading="lazy"
                    frameborder="0" style="border:0"
                    src="https://www.google.com/maps/embed/v1/place?key=AIzaSyBZkgfEiV0p1XY0-7jptEa500_MhqZQUYk&q=Code-Troopers,+37000+Tours+France&zoom=15">
            </iframe></div>
        <div>
            <h2>Code-Troopers</h2>
            <p>
                26 bis rue Abraham Bosse<br>
                37000 Tours - Fr
            </p>
            <p>
                <a href="mailto:contact@code-troopers.com">contact@code-troopers.com</a>
            </p>
            <p>
                <a class="button" href="tel:+33782287216">07 82 28 72 16</a>
            </p>
        </div>
    </div>

    <h1>Suivez nos actualités</h1>

    <ul class="flex">
        <li>
            <a href="https://facebook.com/codetroopers37">
                <i class="fa fa-facebook fa-3x fa-fw"></i>
            </a>
        </li>
        <li>
            <a href="https://twitter.com/codetroopers">
                <i class="fa fa-twitter fa-3x fa-fw"></i>
            </a>
        </li>
        <li>
            <a href="https://github.com/code-troopers">
                <i class="fa fa-github fa-3x fa-fw"></i>
            </a>
        </li>
        <li>
            <a href="/index.xml">
                <i class="fa fa-rss fa-3x fa-fw"></i>
            </a>
        </li>
    </ul>
</section>

<footer>
    <div class="wrapper">
        <a href="#top" class="scroll-to-top">
            <img class="arrow" src="/img/arrow.png" alt="arrow">
        </a>
        <img src="/img/footer_logo.png" alt="logo">
        <div>
            <span>©2014 — 2024 Code-Troopers | <a href="/legals.html">Mentions légales</a></span>
            <span>Design : <a href="https://www.descheval.com/">descheval.com</a> | Développement : Code-Troopers</span>
        </div>
    </div>
</footer>

    
    
      <script src="/main.js"></script>
    
  </body>
</html>
